# UcmPSTools

## Build Status

[![Build Status](https://dev.azure.com/UcMadScientist/UcmPSTools/_apis/build/status/Atreidae.UcmPSTools?branchName=main)](https://dev.azure.com/UcMadScientist/UcmPSTools/_build/latest?definitionId=1&branchName=main)

## Tests

## About UcmPSTools

 UcmPSTools is a collection of PowerShell functions to ease the administration of Microsoft Teams Unified Communications features and its related services.
 If your a Teams Voice engineer or are transitioning from Skype for Business to Teams, you will find alot of these functions useful.

 This initially started out as a scratch pad for my commonly used UC related functions. I took it as an oppertunity to centralize alot of the code I use in my day to day work.
 Instead of just building things bespoke for me, I decided to clean all the functions up, heavily document them and release them on the PowerShell Gallery
 
 Detailed posts for each function will come soon, but for now you can find inline PowerShell help and documentation to get you started.

## Reporting Output

 Most of the functions in this module will return a PSCustomObject indicating the success or failure of each function and some descriptive text along with it.
 Detailed descriptions of each functions output can be found in the comment based help in each function.

 $Return.Status usually returns one of four values
 "OK"      : The operation was sucsessful, nothing of concern
 "Warn"    : The operation was sucsessful, but there is something you should be mindful of (We are trying to create a user that already exists, or we are running low on licences to assign). More information will be found in $Return.Message
 "Error"   : The operation was unsucsessful, Something happend when attempting to perform the operation that we couldnt handle, check $Return.Message for more information
 "Unknown" : Cmdlet reached the end of the fucntion without returning anything, this shouldnt happen, if it does please log an issue on Github with your relevant log files.

 $Return.Message returns descriptive text showing the connected tenant, mainly for logging, reporting or diagnosis.

## List of Functions

### Office365 Connection Related

Functions for checking and connecting to relevant Office365 services

#### New-MSOLConnection

Clears any existing MSOL Connections and connects to MSOL, if user creds arent in memory, the function checks for a creds.xml file in the local folder and loads it into memory.
Should the Creds.xml not be found, it will prompt the user to provide credentials and write a new creds.xml in the current folder.

#### New-SFBOConnection

Clears any existing MSOL Connections and connects to MSOL, if user creds arent in memory, the function checks for a creds.xml file in the local folder and loads it into memory.
Should the Creds.xml not be found, it will prompt the user to provide credentials and write a new creds.xml in the current folder.

#### New-EXHOConnection

*Todo

### Test-MSOLConnection 
This function will test if the current PowerShell Session is connected to Office 365 Azure AD (Using Azure AD v1) and that the PSSession isnt broken
If its not connected for any reason, it will return an error

### Test-SFBOConnection 
This function will test if the current PowerShell Session is connected to Skype for Business Online via either the Skype4B module or the MicrosoftTeams module and that the PSSession isnt broken
If its not connected for any reason, it will then invoke New-SFBOConnection to reconnect

### Test-EXHOConnection 
This function will test if the current PowerShell Session is connected to Exchange Online and that the PSSession isnt broken
If its not connected for any reason, it will then invoke New-EXHOConnection to reconnect

#### A Note on Creds.xml

The creds.xml file is generated by any of the New-*Connection cmdlets and allows for autoreconnection should a session drop mid user migration
This file is encrypted with a per user encryption key provided by Windows.
These files are not portable and cannot be moved from one machine to another, or one user profile to another.

Whilst a Creds.xml is encrypted. It should be looked after like a certificate, should your user profile be compromised it is possible for someone to write a script and execute it in your profile to retrieve the stored credentials.

### User Management Related

Functions for creating, licencing and enabling users

#### Todo

### Call Management Related

Functions related to the creation and management of Call Queues, Auto Attendants, Holidays etc.

#### Todo 2

### PSTN Number Management Related

Functions relating to the assignment, management and checking of PSTN Numbers.

#### Todo 3

### Reporting related

Functions for logging and creation of reports to automated proceedures.
